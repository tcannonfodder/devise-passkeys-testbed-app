<%= form_with(
      scope: :passkey,
      url: emergency_passkey_registration_url(emergency_passkey_registration_token: emergency_passkey_registration_token),
      method: :put,
      data: {
        "challenge_url": new_challenge_emergency_passkey_registrations_url(emergency_passkey_registration_token: emergency_passkey_registration_token),
        "credential_field_name": "passkey[credential]"
      }
) do |f| %>

<h2>Emergency add a new passkey</h2>

  <%= render "devise/shared/error_messages", resource: resource %>
  <%= f.hidden_field :reset_password_token %>

  <fieldset>
    <table>
      <tr>
        <th><%= f.label :label %></th>
        <td><%= f.text_field :label, autofocus: "off", required: true %>
      </tr>
    </table>
  </fieldset>

  <%= f.hidden_field :credential %>

  <button type="submit"><%= image_tag("passkey-black.svg", width: "25", height: "25") %> Add passkey</button>
<% end %>

<%= render "devise/shared/links" %>


<script type="module">
  import {submitFormEvent} from 'registration_form'
  document.querySelector('form').addEventListener('submit', submitFormEvent)
</script>